By NICOLE PERLROTHMARCH 1, 2015
SAN FRANCISCO —  Until its advertising software was discovered deep inside Lenovo personal computers two weeks ago, a little company called Superfish had maintained a surprisingly low profile for an outfit once named America’s fastest-growing software start-up.In 2013, Superfish revenues had increased more than 26,000 percent over the previous three years to $35.3 million. It had advertising deals with some of the biggest names in e-commerce — Amazon, eBay and Alibaba among them.But as the start-up, based in Palo Alto, Calif., searched for new income sources last year, it landed a deal with Lenovo, the world’s largest PC maker, to put its software — often called adware — on several Lenovo consumer PCs.That deal has proved disastrous. Not only has it called into question the business practices of both Lenovo and Superfish, it has shined an unflattering light on makers of this sort of advertising technology.AdvertisementSuperfish’s software, a security researcher revealed, was logging every online movement of the people using those Lenovo machines and hijacking the security system that is supposed to protect online communications and commerce. The Department of Homeland Security even warned Lenovo PC users to remove the software because of the risk it presented.AdvertisementSuperfish’s technology, security experts now say, is a particularly aggressive example of the targeted advertising technology that tracks consumers’ online movements without their knowledge.What made its adware particularly bad, experts say, is that it fooled Lenovo customers into thinking that private sessions with their email service, or bank — secured with encryption that is often represented by the tiny padlock that appears in their web browser — were private, when Superfish, and potentially hackers, could see everything.“The padlock is a means of telling you that who you are talking to is who you think you are talking to. Superfish made that mechanism ineffective,” said Jonathan Mayer, a lawyer and computer science graduate student at Stanford University who specializes in digital privacy.Superfish was co-founded by Adi Pinhas and Michael Chertok, two veterans of the video surveillance industry. Their first start-up, Vigilant Technology, worked with casinos, prisons and governments and used algorithms to scan video footage from surveillance cameras in search of suspicious activity.In 2006, the two began exploring the possibility of applying similar computerized methods to visual searches. They called their new start-up Link-It. Much in the same way that Google is a search engine for text, Siri for voice, and music discovery apps like Shazam help people match songs they hear on the radio to an artist and song title, Superfish aimed to be a “visual search” engine for images.With 12 Ph.D.s on staff and 10 patents for visual search technology, the company’s software crawls the web, using mathematical models to catalog, analyze and match images of plants, dogs or furniture to the exact flower, dog breed or home goods retailer. At one point, they worked with Samsung on a proof-of-concept visual search engine on Samsung cellphones, but a formal partnership was never consummated.In 2009, the co-founders said, they renamed the company Superfish.Five years later, Superfish had accumulated partnerships with more than 100,000 retailers that paid the company through “affiliate” programs, in which retailers gave Superfish a cut of each sale its software encouraged. As Superfish tracks products that appeal to people on the web, its technology serves ads of similar or identical products from its retail partners.AdvertisementLast year, Superfish began experimenting with new sources of revenue. It released a series of free “LikeThat” mobile apps at the iTunes and Android store, such as LikeThat Décor, an app that allows design aficionados or interior designers to snap shots of furniture so that Superfish can locate the same, or similar, products online.The start-up’s executives say they approached Lenovo, based in China, early last year about the possibility of loading their VisualDiscovery software onto its PCs at the factory.The pitch, Lenovo’s executives recall, was that Superfish could “improve our consumer experience” by serving its customers more relevant ads.Please verify you're not a robot by clicking the box.Invalid email address. Please re-enter.You must select a newsletter to subscribe to.View all New York Times newsletters.“The motivation was to enhance the experience,” Peter Hortensius, Lenovo’s chief technology officer said in an interview last week. If a consumer was hovering his mouse over a vase, Mr. Hortensius said, Superfish technology would register his interest in the vase and could show a similar vase, or the same vase at a cheaper price, from a different retailer.“That was the idea at least,” Mr. Hortensius recalled.Neither Lenovo nor Superfish will discuss the financial terms of the deal.Industry experts say that when software is preloaded onto a machine, the hardware maker is usually paid a fee per machine. In the case of adware, they suspect Lenovo was also paid a cut of any Superfish ad revenue generated on their PCs. Lenovo executives will only say that its revenues from the deal were “financially insignificant.”After Lenovo began putting Superfish software onto its consumer PCs last September, consumers were soon complaining in online forums that their web experiences were buggy.Peter Horne, who has worked in the financial services technology industry for 25 years, noticed that the adware was buried so deep in the machine’s operating system that antivirus scanners couldn’t find it.In an interview, Mr. Hortensius said Lenovo’s customers were given the chance to opt out of Superfish when they started their machines, but customers do not recall any opt-in language. Even after Mr. Horne wiped his new Lenovo PC and rebuilt it, his PC was still calling back to Superfish’s servers.AdvertisementWorse still, Superfish’s technology was hijacking the third-party certificate authorities that are used to guarantee the security of encrypted connections between users’ browsers and websites like Bank of America and Google. To circumvent web protections, Superfish served up its own certificate with the help of an Israeli company, Komodia, which specializes in intercepting encrypted communications, so it could insert ads.By doing so, Superfish left Lenovo users vulnerable to hackers. “Websites, such as banking and email, can be spoofed without a warning,” a Homeland Security alert read.In an email, Mr. Pinhas said Superfish was not aware of any security issues with its Lenovo adware until the news broke two weeks ago. He said the Lenovo partnership was the only time Superfish adware had been preloaded into hardware and that it was the first time the company had worked with Komodia, which helped it circumvent web encryption to insert its ads.Mr. Pinhas also maintains that Superfish does not log any personal information on its servers. Citing pending lawsuits, Mr. Pinhas said he could not say more.Lenovo is now facing its own lawsuits — one accuses Lenovo and Superfish of trespassing on personal property and violating wiretap laws — and even angry hackers. For several hours last Wednesday, hackers defaced Lenovo’s website, replacing its contents with images of bored teenagers.Two days later, Lenovo announced a pledge for “cleaner, safer PCs” and said it would eliminate unnecessary adware from its PCs and clearly post what all preloaded software does.“We are not confused as to the depth that this has caused people not to trust us,” Mr. Hortensius said. “We will do our best to make this right. In the process of that, I think we will come out stronger.”He added, “But we have a long way to go to make this right.”A version of this article appears in print on March 2, 2015, on Page B3 of the New York edition with the headline: How Superfish’s Security-Compromising Adware Came to Inhabit Lenovo’s PCs.  Order Reprints| Today's Paper|Subscribe

We’re interested in your feedback on this page. Tell us what you think.